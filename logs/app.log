2025-05-09 09:55:19.072 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Starting Lc4jdemoApplication using Java 17.0.9 with PID 17531 (/Users/bing/lc4jdemo/target/classes started by bing in /Users/bing/lc4jdemo)
2025-05-09 09:55:19.085 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-09 09:55:20.142 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-09 09:55:20.145 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-09 09:55:20.191 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 20 ms. Found 0 Redis repository interfaces.
2025-05-09 09:55:21.165 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-05-09 09:55:21.178 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-09 09:55:21.181 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-09 09:55:21.181 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-09 09:55:21.273 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-09 09:55:21.274 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2111 ms
2025-05-09 09:55:21.693 [main] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 09:55:49.836 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-09 09:55:49.851 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-05-09 09:55:49.864 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Started Lc4jdemoApplication in 31.255 seconds (process running for 32.081)
2025-05-09 09:55:49.872 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 09:57:00.120 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-09 09:57:00.121 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-09 09:57:00.123 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-09 09:57:36.526 [http-nio-8080-exec-1] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: java.lang.NullPointerException: Cannot invoke "java.util.Collection.toArray()" because "c" is null] with root cause
java.lang.NullPointerException: Cannot invoke "java.util.Collection.toArray()" because "c" is null
	at java.base/java.util.LinkedList.addAll(LinkedList.java:412)
	at java.base/java.util.LinkedList.addAll(LinkedList.java:391)
	at java.base/java.util.LinkedList.<init>(LinkedList.java:123)
	at dev.langchain4j.memory.chat.MessageWindowChatMemory.messages(MessageWindowChatMemory.java:84)
	at dev.langchain4j.memory.chat.MessageWindowChatMemory.add(MessageWindowChatMemory.java:59)
	at java.base/java.util.Optional.ifPresent(Optional.java:178)
	at dev.langchain4j.service.DefaultAiServices$1.invoke(DefaultAiServices.java:158)
	at jdk.proxy2/jdk.proxy2.$Proxy86.chat(Unknown Source)
	at com.lc.lc4jdemo.controller.ChatController.chat(ChatController.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-05-09 09:59:00.253 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09 09:59:00.266 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-09 09:59:43.606 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Starting Lc4jdemoApplication using Java 17.0.9 with PID 18175 (/Users/bing/lc4jdemo/target/classes started by bing in /Users/bing/lc4jdemo)
2025-05-09 09:59:43.608 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-09 09:59:44.482 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-09 09:59:44.485 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-09 09:59:44.532 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 20 ms. Found 0 Redis repository interfaces.
2025-05-09 09:59:45.558 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-05-09 09:59:45.574 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-09 09:59:45.577 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-09 09:59:45.577 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-09 09:59:45.664 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-09 09:59:45.666 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1985 ms
2025-05-09 09:59:46.051 [main] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 09:59:51.957 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-09 09:59:51.971 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-05-09 09:59:51.985 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Started Lc4jdemoApplication in 8.823 seconds (process running for 9.757)
2025-05-09 09:59:51.992 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:02:53.770 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09 10:02:53.796 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-09 10:03:09.358 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Starting Lc4jdemoApplication using Java 17.0.9 with PID 18664 (/Users/bing/lc4jdemo/target/classes started by bing in /Users/bing/lc4jdemo)
2025-05-09 10:03:09.361 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-09 10:03:10.245 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-09 10:03:10.248 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-09 10:03:10.302 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 25 ms. Found 0 Redis repository interfaces.
2025-05-09 10:03:11.277 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-05-09 10:03:11.292 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-09 10:03:11.295 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-09 10:03:11.295 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-09 10:03:11.390 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-09 10:03:11.392 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1967 ms
2025-05-09 10:03:11.786 [main] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:03:18.432 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-09 10:03:18.451 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-05-09 10:03:18.471 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Started Lc4jdemoApplication in 9.597 seconds (process running for 10.457)
2025-05-09 10:03:18.477 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:03:30.203 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-09 10:03:30.203 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-09 10:03:30.204 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-09 10:04:18.462 [http-nio-8080-exec-7] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: java.lang.NullPointerException: Cannot invoke "java.util.Collection.toArray()" because "c" is null] with root cause
java.lang.NullPointerException: Cannot invoke "java.util.Collection.toArray()" because "c" is null
	at java.base/java.util.LinkedList.addAll(LinkedList.java:412)
	at java.base/java.util.LinkedList.addAll(LinkedList.java:391)
	at java.base/java.util.LinkedList.<init>(LinkedList.java:123)
	at dev.langchain4j.memory.chat.MessageWindowChatMemory.messages(MessageWindowChatMemory.java:84)
	at dev.langchain4j.memory.chat.MessageWindowChatMemory.add(MessageWindowChatMemory.java:59)
	at java.base/java.util.Optional.ifPresent(Optional.java:178)
	at dev.langchain4j.service.DefaultAiServices$1.invoke(DefaultAiServices.java:158)
	at jdk.proxy2/jdk.proxy2.$Proxy86.chat(Unknown Source)
	at com.lc.lc4jdemo.controller.ChatController.chat(ChatController.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-05-09 10:04:58.943 [http-nio-8080-exec-9] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: java.lang.NullPointerException: Cannot invoke "java.util.Collection.toArray()" because "c" is null] with root cause
java.lang.NullPointerException: Cannot invoke "java.util.Collection.toArray()" because "c" is null
	at java.base/java.util.LinkedList.addAll(LinkedList.java:412)
	at java.base/java.util.LinkedList.addAll(LinkedList.java:391)
	at java.base/java.util.LinkedList.<init>(LinkedList.java:123)
	at dev.langchain4j.memory.chat.MessageWindowChatMemory.messages(MessageWindowChatMemory.java:84)
	at dev.langchain4j.memory.chat.MessageWindowChatMemory.add(MessageWindowChatMemory.java:59)
	at java.base/java.util.Optional.ifPresent(Optional.java:178)
	at dev.langchain4j.service.DefaultAiServices$1.invoke(DefaultAiServices.java:158)
	at jdk.proxy2/jdk.proxy2.$Proxy86.chat(Unknown Source)
	at com.lc.lc4jdemo.controller.ChatController.chat(ChatController.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-05-09 10:06:02.807 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09 10:06:02.814 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-09 10:06:08.924 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Starting Lc4jdemoApplication using Java 17.0.9 with PID 19091 (/Users/bing/lc4jdemo/target/classes started by bing in /Users/bing/lc4jdemo)
2025-05-09 10:06:08.928 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-09 10:06:10.341 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-09 10:06:10.346 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-09 10:06:10.413 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 31 ms. Found 0 Redis repository interfaces.
2025-05-09 10:06:11.989 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-05-09 10:06:12.014 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-09 10:06:12.018 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-09 10:06:12.018 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-09 10:06:12.139 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-09 10:06:12.141 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 3117 ms
2025-05-09 10:06:12.667 [main] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:06:20.408 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-09 10:06:20.431 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-05-09 10:06:20.455 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Started Lc4jdemoApplication in 12.382 seconds (process running for 13.681)
2025-05-09 10:06:20.467 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:13:03.403 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-09 10:13:03.404 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-09 10:13:03.410 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 6 ms
2025-05-09 10:16:08.286 [http-nio-8080-exec-7] INFO  c.l.l.a.functioncall.WeatherTools - 查询 成都 的天气，单位：C
2025-05-09 10:16:08.307 [http-nio-8080-exec-7] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 10:16:08.416 [http-nio-8080-exec-7] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: com.alibaba.dashscope.exception.ApiException: {"statusCode":400,"message":"<400> InternalError.Algo.InvalidParameter: messages with role \"tool\" must be a response to a preceeding message with \"tool_calls\".","code":"InvalidParameter","isJson":true,"requestId":"a4fd95d5-9947-9f47-a03f-3667c2b32e7a"}; status body:{"statusCode":400,"message":"<400> InternalError.Algo.InvalidParameter: messages with role \"tool\" must be a response to a preceeding message with \"tool_calls\".","code":"InvalidParameter","isJson":true,"requestId":"a4fd95d5-9947-9f47-a03f-3667c2b32e7a"}] with root cause
com.alibaba.dashscope.exception.ApiException: {"statusCode":400,"message":"<400> InternalError.Algo.InvalidParameter: messages with role \"tool\" must be a response to a preceeding message with \"tool_calls\".","code":"InvalidParameter","isJson":true,"requestId":"a4fd95d5-9947-9f47-a03f-3667c2b32e7a"}
	at com.alibaba.dashscope.protocol.okhttp.OkHttpHttpClient.send(OkHttpHttpClient.java:236)
	at com.alibaba.dashscope.api.SynchronizeHalfDuplexApi.call(SynchronizeHalfDuplexApi.java:58)
	at com.alibaba.dashscope.aigc.generation.Generation.call(Generation.java:102)
	at dev.langchain4j.model.dashscope.QwenChatModel.generateByNonMultimodalModel(QwenChatModel.java:154)
	at dev.langchain4j.model.dashscope.QwenChatModel.generate(QwenChatModel.java:109)
	at dev.langchain4j.service.DefaultAiServices$1.invoke(DefaultAiServices.java:280)
	at jdk.proxy2/jdk.proxy2.$Proxy86.chat(Unknown Source)
	at com.lc.lc4jdemo.controller.ChatController.chat(ChatController.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-05-09 10:21:20.496 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:21:21.205 [http-nio-8080-exec-9] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 10:21:21.205 [http-nio-8080-exec-9] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: ToolExecutionResultMessage { id = "call_4aa263c2420a410493cf08" toolName = "getWeather" text = "【成都】当前温度：25°C，天气晴朗" }
2025-05-09 10:46:38.284 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:46:38.551 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09 10:46:44.942 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Starting Lc4jdemoApplication using Java 17.0.9 with PID 24781 (/Users/bing/lc4jdemo/target/classes started by bing in /Users/bing/lc4jdemo)
2025-05-09 10:46:44.944 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-09 10:46:45.846 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-09 10:46:45.849 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-09 10:46:45.899 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 23 ms. Found 0 Redis repository interfaces.
2025-05-09 10:46:46.833 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-05-09 10:46:46.846 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-09 10:46:46.848 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-09 10:46:46.848 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-09 10:46:46.929 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-09 10:46:46.931 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1924 ms
2025-05-09 10:46:47.362 [main] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:47:16.120 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-09 10:47:16.134 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-05-09 10:47:16.148 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Started Lc4jdemoApplication in 31.672 seconds (process running for 32.588)
2025-05-09 10:47:16.154 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:47:20.694 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-09 10:47:20.695 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-09 10:47:20.696 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-09 10:47:21.591 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - The first non-system message must be a user message, but found: AiMessage { text = "You are a helpful assistant. 你好！今天过得怎么样？需要我帮忙查询些什么吗？" toolExecutionRequests = null }
2025-05-09 10:47:21.592 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 10:47:21.592 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: ToolExecutionResultMessage { id = "call_4aa263c2420a410493cf08" toolName = "getWeather" text = "【成都】当前温度：25°C，天气晴朗" }
2025-05-09 10:47:21.593 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 10:48:09.656 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09 10:48:15.317 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Starting Lc4jdemoApplication using Java 17.0.9 with PID 25004 (/Users/bing/lc4jdemo/target/classes started by bing in /Users/bing/lc4jdemo)
2025-05-09 10:48:15.319 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-09 10:48:16.081 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-09 10:48:16.084 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-09 10:48:16.122 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
2025-05-09 10:48:17.093 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-05-09 10:48:17.108 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-09 10:48:17.111 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-09 10:48:17.112 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-09 10:48:17.187 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-09 10:48:17.189 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1812 ms
2025-05-09 10:48:17.502 [main] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:48:22.837 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-09 10:48:22.853 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-05-09 10:48:22.870 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Started Lc4jdemoApplication in 7.918 seconds (process running for 8.715)
2025-05-09 10:48:22.873 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:48:47.028 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-09 10:48:47.029 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-09 10:48:47.030 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-09 10:48:48.007 [http-nio-8080-exec-1] WARN  dev.langchain4j.internal.RetryUtils - Exception was thrown on attempt 1 of 3
java.lang.RuntimeException: status code: 400; body: {"error":"registry.ollama.ai/library/deepseek-r1:32b does not support tools"}
	at dev.langchain4j.model.ollama.OllamaClient.toException(OllamaClient.java:275)
	at dev.langchain4j.model.ollama.OllamaClient.chat(OllamaClient.java:102)
	at dev.langchain4j.model.ollama.OllamaChatModel.lambda$doGenerate$0(OllamaChatModel.java:124)
	at dev.langchain4j.internal.RetryUtils$RetryPolicy.withRetry(RetryUtils.java:192)
	at dev.langchain4j.internal.RetryUtils.withRetry(RetryUtils.java:229)
	at dev.langchain4j.model.ollama.OllamaChatModel.doGenerate(OllamaChatModel.java:124)
	at dev.langchain4j.model.ollama.OllamaChatModel.generate(OllamaChatModel.java:106)
	at dev.langchain4j.service.DefaultAiServices$1.invoke(DefaultAiServices.java:229)
	at jdk.proxy2/jdk.proxy2.$Proxy86.chat(Unknown Source)
	at com.lc.lc4jdemo.controller.ChatController.chat(ChatController.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-05-09 10:48:48.573 [http-nio-8080-exec-1] WARN  dev.langchain4j.internal.RetryUtils - Exception was thrown on attempt 2 of 3
java.lang.RuntimeException: status code: 400; body: {"error":"registry.ollama.ai/library/deepseek-r1:32b does not support tools"}
	at dev.langchain4j.model.ollama.OllamaClient.toException(OllamaClient.java:275)
	at dev.langchain4j.model.ollama.OllamaClient.chat(OllamaClient.java:102)
	at dev.langchain4j.model.ollama.OllamaChatModel.lambda$doGenerate$0(OllamaChatModel.java:124)
	at dev.langchain4j.internal.RetryUtils$RetryPolicy.withRetry(RetryUtils.java:192)
	at dev.langchain4j.internal.RetryUtils.withRetry(RetryUtils.java:229)
	at dev.langchain4j.model.ollama.OllamaChatModel.doGenerate(OllamaChatModel.java:124)
	at dev.langchain4j.model.ollama.OllamaChatModel.generate(OllamaChatModel.java:106)
	at dev.langchain4j.service.DefaultAiServices$1.invoke(DefaultAiServices.java:229)
	at jdk.proxy2/jdk.proxy2.$Proxy86.chat(Unknown Source)
	at com.lc.lc4jdemo.controller.ChatController.chat(ChatController.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-05-09 10:48:49.450 [http-nio-8080-exec-1] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: java.lang.RuntimeException: java.lang.RuntimeException: status code: 400; body: {"error":"registry.ollama.ai/library/deepseek-r1:32b does not support tools"}] with root cause
java.lang.RuntimeException: status code: 400; body: {"error":"registry.ollama.ai/library/deepseek-r1:32b does not support tools"}
	at dev.langchain4j.model.ollama.OllamaClient.toException(OllamaClient.java:275)
	at dev.langchain4j.model.ollama.OllamaClient.chat(OllamaClient.java:102)
	at dev.langchain4j.model.ollama.OllamaChatModel.lambda$doGenerate$0(OllamaChatModel.java:124)
	at dev.langchain4j.internal.RetryUtils$RetryPolicy.withRetry(RetryUtils.java:192)
	at dev.langchain4j.internal.RetryUtils.withRetry(RetryUtils.java:229)
	at dev.langchain4j.model.ollama.OllamaChatModel.doGenerate(OllamaChatModel.java:124)
	at dev.langchain4j.model.ollama.OllamaChatModel.generate(OllamaChatModel.java:106)
	at dev.langchain4j.service.DefaultAiServices$1.invoke(DefaultAiServices.java:229)
	at jdk.proxy2/jdk.proxy2.$Proxy86.chat(Unknown Source)
	at com.lc.lc4jdemo.controller.ChatController.chat(ChatController.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-05-09 10:48:58.917 [http-nio-8080-exec-2] WARN  dev.langchain4j.internal.RetryUtils - Exception was thrown on attempt 1 of 3
java.lang.RuntimeException: status code: 400; body: {"error":"registry.ollama.ai/library/deepseek-r1:32b does not support tools"}
	at dev.langchain4j.model.ollama.OllamaClient.toException(OllamaClient.java:275)
	at dev.langchain4j.model.ollama.OllamaClient.chat(OllamaClient.java:102)
	at dev.langchain4j.model.ollama.OllamaChatModel.lambda$doGenerate$0(OllamaChatModel.java:124)
	at dev.langchain4j.internal.RetryUtils$RetryPolicy.withRetry(RetryUtils.java:192)
	at dev.langchain4j.internal.RetryUtils.withRetry(RetryUtils.java:229)
	at dev.langchain4j.model.ollama.OllamaChatModel.doGenerate(OllamaChatModel.java:124)
	at dev.langchain4j.model.ollama.OllamaChatModel.generate(OllamaChatModel.java:106)
	at dev.langchain4j.service.DefaultAiServices$1.invoke(DefaultAiServices.java:229)
	at jdk.proxy2/jdk.proxy2.$Proxy86.chat(Unknown Source)
	at com.lc.lc4jdemo.controller.ChatController.chat(ChatController.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-05-09 10:48:59.531 [http-nio-8080-exec-2] WARN  dev.langchain4j.internal.RetryUtils - Exception was thrown on attempt 2 of 3
java.lang.RuntimeException: status code: 400; body: {"error":"registry.ollama.ai/library/deepseek-r1:32b does not support tools"}
	at dev.langchain4j.model.ollama.OllamaClient.toException(OllamaClient.java:275)
	at dev.langchain4j.model.ollama.OllamaClient.chat(OllamaClient.java:102)
	at dev.langchain4j.model.ollama.OllamaChatModel.lambda$doGenerate$0(OllamaChatModel.java:124)
	at dev.langchain4j.internal.RetryUtils$RetryPolicy.withRetry(RetryUtils.java:192)
	at dev.langchain4j.internal.RetryUtils.withRetry(RetryUtils.java:229)
	at dev.langchain4j.model.ollama.OllamaChatModel.doGenerate(OllamaChatModel.java:124)
	at dev.langchain4j.model.ollama.OllamaChatModel.generate(OllamaChatModel.java:106)
	at dev.langchain4j.service.DefaultAiServices$1.invoke(DefaultAiServices.java:229)
	at jdk.proxy2/jdk.proxy2.$Proxy86.chat(Unknown Source)
	at com.lc.lc4jdemo.controller.ChatController.chat(ChatController.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-05-09 10:49:00.318 [http-nio-8080-exec-2] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: java.lang.RuntimeException: java.lang.RuntimeException: status code: 400; body: {"error":"registry.ollama.ai/library/deepseek-r1:32b does not support tools"}] with root cause
java.lang.RuntimeException: status code: 400; body: {"error":"registry.ollama.ai/library/deepseek-r1:32b does not support tools"}
	at dev.langchain4j.model.ollama.OllamaClient.toException(OllamaClient.java:275)
	at dev.langchain4j.model.ollama.OllamaClient.chat(OllamaClient.java:102)
	at dev.langchain4j.model.ollama.OllamaChatModel.lambda$doGenerate$0(OllamaChatModel.java:124)
	at dev.langchain4j.internal.RetryUtils$RetryPolicy.withRetry(RetryUtils.java:192)
	at dev.langchain4j.internal.RetryUtils.withRetry(RetryUtils.java:229)
	at dev.langchain4j.model.ollama.OllamaChatModel.doGenerate(OllamaChatModel.java:124)
	at dev.langchain4j.model.ollama.OllamaChatModel.generate(OllamaChatModel.java:106)
	at dev.langchain4j.service.DefaultAiServices$1.invoke(DefaultAiServices.java:229)
	at jdk.proxy2/jdk.proxy2.$Proxy86.chat(Unknown Source)
	at com.lc.lc4jdemo.controller.ChatController.chat(ChatController.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-05-09 10:53:30.181 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09 10:53:30.197 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-09 10:53:36.414 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Starting Lc4jdemoApplication using Java 17.0.9 with PID 25882 (/Users/bing/lc4jdemo/target/classes started by bing in /Users/bing/lc4jdemo)
2025-05-09 10:53:36.417 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-09 10:53:37.306 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-09 10:53:37.309 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-09 10:53:37.354 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 22 ms. Found 0 Redis repository interfaces.
2025-05-09 10:53:38.478 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-05-09 10:53:38.500 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-09 10:53:38.503 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-09 10:53:38.503 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-09 10:53:38.601 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-09 10:53:38.603 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2119 ms
2025-05-09 10:53:39.123 [main] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:54:07.002 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-09 10:54:07.015 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-05-09 10:54:07.028 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Started Lc4jdemoApplication in 31.138 seconds (process running for 32.121)
2025-05-09 10:54:07.034 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 10:55:04.752 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-09 10:55:04.752 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-09 10:55:04.754 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-05-09 10:55:05.771 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 10:55:05.772 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: ToolExecutionResultMessage { id = "call_4aa263c2420a410493cf08" toolName = "getWeather" text = "【成都】当前温度：25°C，天气晴朗" }
2025-05-09 10:55:05.772 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 10:55:05.773 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 10:55:05.773 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 10:55:05.773 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.854 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - The first non-system message must be a user message, but found: AiMessage { text = "You are a helpful assistant. 你叫大兵呀！有什么我可以帮你的吗？" toolExecutionRequests = null }
2025-05-09 11:03:25.854 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - The first non-system message must be a user message, but found: AiMessage { text = "You are a helpful assistant. 你叫大兵呀！有什么我可以帮你的吗？" toolExecutionRequests = null }
2025-05-09 11:03:25.860 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.860 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.860 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: ToolExecutionResultMessage { id = "call_4aa263c2420a410493cf08" toolName = "getWeather" text = "【成都】当前温度：25°C，天气晴朗" }
2025-05-09 11:03:25.860 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: ToolExecutionResultMessage { id = "call_4aa263c2420a410493cf08" toolName = "getWeather" text = "【成都】当前温度：25°C，天气晴朗" }
2025-05-09 11:03:25.860 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.860 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.861 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.861 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.862 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.862 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.862 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.862 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.862 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.862 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:03:25.917 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09 11:03:33.026 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Starting Lc4jdemoApplication using Java 17.0.9 with PID 27316 (/Users/bing/lc4jdemo/target/classes started by bing in /Users/bing/lc4jdemo)
2025-05-09 11:03:33.030 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-09 11:03:33.882 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-09 11:03:33.885 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-09 11:03:33.928 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 20 ms. Found 0 Redis repository interfaces.
2025-05-09 11:03:34.851 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-05-09 11:03:34.865 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-09 11:03:34.867 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-09 11:03:34.867 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-09 11:03:34.939 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-09 11:03:34.940 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1835 ms
2025-05-09 11:03:35.317 [main] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 11:04:02.602 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-09 11:04:02.617 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-05-09 11:04:02.635 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Started Lc4jdemoApplication in 30.062 seconds (process running for 31.065)
2025-05-09 11:04:02.641 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 11:05:02.291 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-09 11:05:02.292 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-09 11:05:02.293 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-09 11:05:03.126 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:05:03.136 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: ToolExecutionResultMessage { id = "call_4aa263c2420a410493cf08" toolName = "getWeather" text = "【成都】当前温度：25°C，天气晴朗" }
2025-05-09 11:05:03.136 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:05:03.137 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:05:03.137 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:05:03.137 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:05:03.137 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:05:03.138 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:10:45.432 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 成都 的天气，单位：C
2025-05-09 11:10:45.443 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:10:45.444 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:10:45.444 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:10:45.444 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:10:45.445 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:10:45.445 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:11:21.784 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:11:21.785 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:11:21.786 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:11:21.786 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:11:23.031 [http-nio-8080-exec-3] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:11:23.038 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:11:23.038 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:11:23.039 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:11:23.039 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:11:23.157 [http-nio-8080-exec-3] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: com.alibaba.dashscope.exception.ApiException: {"statusCode":400,"message":"<400> InternalError.Algo.InvalidParameter: messages with role \"tool\" must be a response to a preceeding message with \"tool_calls\".","code":"InvalidParameter","isJson":true,"requestId":"140f70d9-e448-9f1c-95d6-aff70c1d9183"}; status body:{"statusCode":400,"message":"<400> InternalError.Algo.InvalidParameter: messages with role \"tool\" must be a response to a preceeding message with \"tool_calls\".","code":"InvalidParameter","isJson":true,"requestId":"140f70d9-e448-9f1c-95d6-aff70c1d9183"}] with root cause
com.alibaba.dashscope.exception.ApiException: {"statusCode":400,"message":"<400> InternalError.Algo.InvalidParameter: messages with role \"tool\" must be a response to a preceeding message with \"tool_calls\".","code":"InvalidParameter","isJson":true,"requestId":"140f70d9-e448-9f1c-95d6-aff70c1d9183"}
	at com.alibaba.dashscope.protocol.okhttp.OkHttpHttpClient.send(OkHttpHttpClient.java:236)
	at com.alibaba.dashscope.api.SynchronizeHalfDuplexApi.call(SynchronizeHalfDuplexApi.java:58)
	at com.alibaba.dashscope.aigc.generation.Generation.call(Generation.java:102)
	at dev.langchain4j.model.dashscope.QwenChatModel.generateByNonMultimodalModel(QwenChatModel.java:154)
	at dev.langchain4j.model.dashscope.QwenChatModel.generate(QwenChatModel.java:109)
	at dev.langchain4j.service.DefaultAiServices$1.invoke(DefaultAiServices.java:280)
	at jdk.proxy2/jdk.proxy2.$Proxy86.chat(Unknown Source)
	at com.lc.lc4jdemo.controller.ChatController.chat(ChatController.java:29)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-05-09 11:11:42.917 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:11:42.917 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:11:42.918 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:11:42.918 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: ToolExecutionResultMessage { id = "call_9413e987f31f43eb8c858c" toolName = "getWeather" text = "【武汉】当前温度：25°C，天气晴朗" }
2025-05-09 11:14:12.654 [http-nio-8080-exec-4] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:14:12.667 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:14:12.668 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:14:12.670 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: ToolExecutionResultMessage { id = "call_9413e987f31f43eb8c858c" toolName = "getWeather" text = "【武汉】当前温度：25°C，天气晴朗" }
2025-05-09 11:14:12.672 [http-nio-8080-exec-4] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:39:52.281 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 11:39:52.420 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09 11:39:52.431 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-09 11:39:58.954 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Starting Lc4jdemoApplication using Java 17.0.9 with PID 32401 (/Users/bing/lc4jdemo/target/classes started by bing in /Users/bing/lc4jdemo)
2025-05-09 11:39:58.956 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - No active profile set, falling back to 1 default profile: "default"
2025-05-09 11:39:59.983 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-09 11:39:59.986 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-09 11:40:00.041 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 26 ms. Found 0 Redis repository interfaces.
2025-05-09 11:40:01.038 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-05-09 11:40:01.051 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-05-09 11:40:01.053 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-09 11:40:01.054 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-09 11:40:01.132 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-09 11:40:01.134 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2103 ms
2025-05-09 11:40:01.480 [main] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 11:40:29.938 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-05-09 11:40:29.950 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-05-09 11:40:29.962 [main] INFO  com.lc.lc4jdemo.Lc4jdemoApplication - Started Lc4jdemoApplication in 31.481 seconds (process running for 32.514)
2025-05-09 11:40:29.967 [scheduling-1] INFO  c.l.l.r.m.DynamicPromptTemplateProvider - reload prompt success prompt path /Users/bing/Documents/msg_pool_prompt.md
2025-05-09 11:40:52.618 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-09 11:40:52.618 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-09 11:40:52.619 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-09 11:40:53.426 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_9413e987f31f43eb8c858c
2025-05-09 11:40:53.427 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_ca85c3a977524e65ae8f2a
2025-05-09 11:40:53.429 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_9413e987f31f43eb8c858c
2025-05-09 11:40:53.429 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_ca85c3a977524e65ae8f2a
2025-05-09 11:40:53.447 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:40:53.447 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:40:53.448 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:06.841 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:06.854 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_daf193be073c4d78865bed
2025-05-09 11:41:06.854 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:06.854 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:06.855 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:12.513 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_daf193be073c4d78865bed
2025-05-09 11:41:12.515 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:12.519 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_c5203df03b57471f8bd3d8
2025-05-09 11:41:12.519 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:12.519 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:12.519 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:25.198 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_c5203df03b57471f8bd3d8
2025-05-09 11:41:25.200 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:25.204 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_d6984d655e3f47abb5c15b
2025-05-09 11:41:25.204 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:25.204 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:25.204 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:28.581 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_d6984d655e3f47abb5c15b
2025-05-09 11:41:28.583 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:28.587 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_dd03ba1bd4d14298ae3301
2025-05-09 11:41:28.587 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:28.588 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:28.588 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:30.936 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_dd03ba1bd4d14298ae3301
2025-05-09 11:41:30.938 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:30.944 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_02c14502e92143bc948727
2025-05-09 11:41:30.945 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:30.945 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:30.945 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:34.930 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_02c14502e92143bc948727
2025-05-09 11:41:34.933 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:34.937 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_a8c279c680a44c36b9d18d
2025-05-09 11:41:34.938 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:34.938 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:34.938 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:40.050 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_a8c279c680a44c36b9d18d
2025-05-09 11:41:40.053 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:40.059 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_a3372ca8a3eb4b42988093
2025-05-09 11:41:40.059 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:40.060 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:40.060 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:41.585 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_a3372ca8a3eb4b42988093
2025-05-09 11:41:41.588 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:41.594 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_87c66920da8e436da63d4f
2025-05-09 11:41:41.594 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:41.594 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:41.594 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:43.631 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_87c66920da8e436da63d4f
2025-05-09 11:41:43.633 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:43.637 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_ea74cb3380ef44d28200db
2025-05-09 11:41:43.637 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:43.637 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:43.637 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:45.152 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_ea74cb3380ef44d28200db
2025-05-09 11:41:45.154 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:45.160 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_8a4a9f67f6c448eab470c0
2025-05-09 11:41:45.160 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:45.160 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:45.160 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:46.805 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_8a4a9f67f6c448eab470c0
2025-05-09 11:41:46.807 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:46.812 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_ecf4096cea1e4c31b1cdf3
2025-05-09 11:41:46.812 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:46.812 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:46.812 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:47.939 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_ecf4096cea1e4c31b1cdf3
2025-05-09 11:41:47.940 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:47.945 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_8c78fe542304403ebab7c0
2025-05-09 11:41:47.945 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:47.945 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:47.945 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:51.416 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_8c78fe542304403ebab7c0
2025-05-09 11:41:51.419 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:51.424 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_38121d9c4657461c98323f
2025-05-09 11:41:51.424 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""成都天气怎么样"" }] }
2025-05-09 11:41:51.424 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:51.424 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:53.042 [http-nio-8080-exec-1] WARN  c.l.l.aiservice.memory.MemoryConfig - 移除非法 ToolMessage，toolCallId: call_38121d9c4657461c98323f
2025-05-09 11:41:53.043 [http-nio-8080-exec-1] INFO  c.l.l.a.functioncall.WeatherTools - 查询 武汉 的天气，单位：C
2025-05-09 11:41:53.049 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:41:53.049 [http-nio-8080-exec-1] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:42:19.621 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - The first non-system message must be a user message, but found: AiMessage { text = "成都当前的温度是25°C，并且天气晴朗。如果您需要更详细的天气预报信息，请告诉我！" toolExecutionRequests = null }
2025-05-09 11:42:19.622 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:42:19.622 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:42:22.342 [http-nio-8080-exec-3] INFO  c.l.l.a.functioncall.WeatherTools - 查询 成都 的天气，单位：C
2025-05-09 11:42:22.347 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:42:22.347 [http-nio-8080-exec-3] WARN  d.l.model.dashscope.QwenHelper - User/Tool-execution-result messages and AI messages should alternate. Drop duplicated message: UserMessage { name = null contents = [TextContent { text = ""武汉的天气怎么样"" }] }
2025-05-09 11:42:41.810 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09 11:42:41.818 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
